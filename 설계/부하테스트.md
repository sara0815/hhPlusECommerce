## 부하테스트
### 부하테스트 대상 (step19)
- 선착순 쿠폰 발급
  - 선정 목적 : 한번에 많은 사용자가 몰릴 경우에 대해 peak test 를 하게 되었다.
  - 시나리오 : 1000명의 가상 유저를 5초간 빠르게 증가 시킨 후 10초간 1000명의 가상의 유저를 유지시키고 5초간 감소시킨다.

![부하테스트1.png](%EB%B6%80%ED%95%98%ED%85%8C%EC%8A%A4%ED%8A%B81.png)
![부하테스트2.png](%EB%B6%80%ED%95%98%ED%85%8C%EC%8A%A4%ED%8A%B82.png)
![부하테스트3.png](%EB%B6%80%ED%95%98%ED%85%8C%EC%8A%A4%ED%8A%B83.png)
### 병목 탐색
- 실패 건수도 있고 성능이 좋지 않은 것을 확인할 수 있다. (최대 4.15s 소요)
- 카프카 컨슈머 렉에 많이 쌓여있는 것을 확인할 수 있었다. 

### 개선
- 카프카로 쿠폰 발급을 발행하기 전에 레디스를 사용하여 쿠폰 발행 가능한 수량만큼만 카프카로 발행시키고 나머지는 쿠폰 발급 실패로 리턴하는것이 병목을 줄일 수 있을 것으로 보인다.